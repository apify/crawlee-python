# Environment Configuration Template
# Copy this file to .env.local and customize for your environment

# ============================================================================
# CRAWLER SETTINGS
# ============================================================================

# Maximum number of pages to crawl per run
# Set to 0 for unlimited (use with caution)
MAX_REQUESTS_PER_CRAWL=1000

# Number of concurrent requests
# Higher values = faster crawling, but more resource intensive
MAX_CONCURRENCY=5

# Request timeout in seconds
REQUEST_TIMEOUT=30

# User-Agent string for crawler requests
# Identify your bot clearly and provide contact info
USER_AGENT="CRA-Tax-Documentation-Bot/1.0 (+https://yourdomain.com/bot-info)"

# ============================================================================
# RATE LIMITING
# ============================================================================

# Maximum requests per minute (hard limit to avoid overwhelming servers)
# Recommended: 60 for production, 10-20 for testing
MAX_REQUESTS_PER_MINUTE=60

# Minimum delay between requests in milliseconds
# Adds jitter to appear more human-like
MIN_DELAY_BETWEEN_REQUESTS_MS=100

# Maximum delay between requests in milliseconds
# Crawlee randomizes delays within this range
MAX_DELAY_BETWEEN_REQUESTS_MS=500

# Minimum delay between requests to the same domain (seconds)
# Respect server resources - recommended minimum: 1 second
MIN_REQUEST_DELAY=1.0

# Maximum delay between requests (for random jitter)
MAX_REQUEST_DELAY=3.0

# Maximum retries for failed requests
MAX_RETRIES=3

# Retry backoff multiplier (exponential backoff)
RETRY_BACKOFF_MULTIPLIER=2.0

# ============================================================================
# SECURITY & POLITENESS
# ============================================================================

# Respect robots.txt directives (recommended: true)
# Set to false only if you have explicit permission to bypass robots.txt
RESPECT_ROBOTS_TXT=true

# ============================================================================
# STORAGE SETTINGS
# ============================================================================

# Base directory for local storage
# Crawlee will create subdirectories for datasets, key-value stores, etc.
STORAGE_DIR=./storage

# Dataset name for crawled documents
DATASET_NAME=cra_tax_documents

# Key-value store name for metadata
KV_STORE_NAME=crawler_metadata

# ============================================================================
# QDRANT SETTINGS
# ============================================================================

# Qdrant connection URL
# Local development: http://localhost:6333
# Production: Your VPS IP or domain
QDRANT_URL=http://localhost:6333

# Qdrant API key (leave empty for local development without auth)
QDRANT_API_KEY=

# Qdrant collection name for storing document embeddings
QDRANT_COLLECTION=cra_tax_documents

# Vector dimension (must match embedding model)
# all-MiniLM-L6-v2: 384
# all-mpnet-base-v2: 768
VECTOR_DIMENSION=384

# Distance metric for vector similarity
# Options: Cosine, Euclidean, Dot
VECTOR_DISTANCE=Cosine

# ============================================================================
# EMBEDDING SETTINGS
# ============================================================================

# Sentence-transformers model name
# Recommended options:
#   - all-MiniLM-L6-v2 (fast, 384 dim)
#   - all-mpnet-base-v2 (better quality, 768 dim)
EMBEDDING_MODEL=all-MiniLM-L6-v2

# Batch size for embedding generation
# Adjust based on available RAM
EMBEDDING_BATCH_SIZE=32

# Device for embedding generation
# Options: cpu, cuda, mps (Mac M1/M2)
EMBEDDING_DEVICE=cpu

# ============================================================================
# DOCUMENT PROCESSING
# ============================================================================

# Chunk size for text splitting (in tokens/characters)
# Smaller chunks = more precise retrieval, larger chunks = more context
CHUNK_SIZE=800

# Overlap between chunks (in tokens/characters)
# Helps maintain context across chunk boundaries
CHUNK_OVERLAP=200

# Minimum chunk size (discard smaller chunks)
MIN_CHUNK_SIZE=100

# Maximum chunk size (hard limit)
MAX_CHUNK_SIZE=1500

# ============================================================================
# LOGGING
# ============================================================================

# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# Log format
# Options: json, text
LOG_FORMAT=text

# Log file path (leave empty to log to console only)
LOG_FILE=

# ============================================================================
# CRAWLER TARGETS
# ============================================================================

# Starting URLs for the crawler (comma-separated)
# CRA tax documentation pages
START_URLS=https://www.canada.ca/en/revenue-agency.html

# URL patterns to include (regex, comma-separated)
# Only crawl URLs matching these patterns
INCLUDE_URL_PATTERNS=/en/revenue-agency/.*,/en/services/tax/.*

# URL patterns to exclude (regex, comma-separated)
# Skip URLs matching these patterns (e.g., login pages, search results)
EXCLUDE_URL_PATTERNS=/login,/search,/auth

# Maximum crawl depth from start URLs
# 0 = only start URLs, 1 = start URLs + direct links, etc.
MAX_CRAWL_DEPTH=3

# ============================================================================
# PRODUCTION / DEPLOYMENT
# ============================================================================

# Environment: development, production
ENVIRONMENT=development

# Enable debug mode (verbose logging, no external requests in some cases)
DEBUG=false

# Monitoring/alerting webhook URL (optional)
ALERT_WEBHOOK_URL=

# Health check port (for monitoring)
HEALTH_CHECK_PORT=8080

# ============================================================================
# DOCKER / COMPOSE
# ============================================================================

# Qdrant container name
QDRANT_CONTAINER_NAME=qdrant-taxrag

# Qdrant exposed port
QDRANT_PORT=6333

# Qdrant gRPC port
QDRANT_GRPC_PORT=6334

# Qdrant data volume path
QDRANT_VOLUME_PATH=./qdrant_storage
